<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Debug FlowAI</title>
  <style>
    body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #00ff00; }
    #console { background: #000; padding: 15px; border: 1px solid #333; margin: 20px 0; max-height: 400px; overflow-y: auto; }
    .error { color: #ff5555; }
    .warn { color: #ffaa00; }
    .info { color: #55aaff; }
    .log { color: #00ff00; }
    iframe { width: 100%; height: 600px; border: 2px solid #333; }
  </style>
</head>
<body>
  <h1>üîç FlowAI Debug Console</h1>
  <div id="status">Loading app...</div>
  
  <h2>Console Output:</h2>
  <div id="console"></div>
  
  <h2>App Preview:</h2>
  <iframe src="/" id="app-frame"></iframe>
  
  <script>
    const consoleDiv = document.getElementById('console');
    const statusDiv = document.getElementById('status');
    
    // Intercept console messages
    const originalLog = console.log;
    const originalError = console.error;
    const originalWarn = console.warn;
    const originalInfo = console.info;
    
    function addToConsole(type, ...args) {
      const line = document.createElement('div');
      line.className = type;
      line.textContent = `[${type.toUpperCase()}] ${args.join(' ')}`;
      consoleDiv.appendChild(line);
      consoleDiv.scrollTop = consoleDiv.scrollHeight;
    }
    
    console.log = function(...args) {
      addToConsole('log', ...args);
      originalLog.apply(console, args);
    };
    
    console.error = function(...args) {
      addToConsole('error', ...args);
      originalError.apply(console, args);
    };
    
    console.warn = function(...args) {
      addToConsole('warn', ...args);
      originalWarn.apply(console, args);
    };
    
    console.info = function(...args) {
      addToConsole('info', ...args);
      originalInfo.apply(console, args);
    };
    
    // Monitor iframe errors
    const iframe = document.getElementById('app-frame');
    iframe.onload = function() {
      statusDiv.innerHTML = '<span style="color: #00ff00;">‚úì App loaded</span>';
      
      try {
        const iframeWindow = iframe.contentWindow;
        
        // Intercept iframe console
        iframeWindow.console.log = console.log;
        iframeWindow.console.error = console.error;
        iframeWindow.console.warn = console.warn;
        iframeWindow.console.info = console.info;
        
        // Capture iframe errors
        iframeWindow.addEventListener('error', function(e) {
          addToConsole('error', `IFRAME ERROR: ${e.message} at ${e.filename}:${e.lineno}`);
        });
        
        iframeWindow.addEventListener('unhandledrejection', function(e) {
          addToConsole('error', `UNHANDLED PROMISE: ${e.reason}`);
        });
        
      } catch(e) {
        addToConsole('warn', 'Could not intercept iframe console (CORS)');
      }
    };
    
    iframe.onerror = function() {
      statusDiv.innerHTML = '<span style="color: #ff5555;">‚úó Failed to load app</span>';
    };
    
    // Global error handler
    window.addEventListener('error', function(e) {
      addToConsole('error', `GLOBAL ERROR: ${e.message} at ${e.filename}:${e.lineno}`);
    });
    
    window.addEventListener('unhandledrejection', function(e) {
      addToConsole('error', `UNHANDLED PROMISE: ${e.reason}`);
    });
    
    addToConsole('info', 'Debug console initialized');
    addToConsole('info', 'Loading app at http://localhost:5173...');
  </script>
</body>
</html>

